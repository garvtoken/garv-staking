<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GARV Token ‚Äì Stake Now</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>

<style>
*{box-sizing:border-box;font-family:Poppins,Arial,sans-serif}
body{
  margin:0;min-height:100vh;color:#fff;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364)
}
.container{max-width:420px;margin:auto;padding:18px}
.logo{text-align:center;margin-top:10px}
.logo img{height:70px}
h1{text-align:center;font-size:24px;margin:10px 0 18px}
.card{
  background:rgba(15,23,42,.9);
  border-radius:16px;padding:18px;margin-bottom:16px;
  box-shadow:0 10px 28px rgba(0,0,0,.35)
}
button{
  width:100%;padding:14px;border-radius:12px;border:none;
  background:linear-gradient(135deg,#00c6ff,#0072ff);
  color:#fff;font-size:16px;font-weight:600;cursor:pointer
}
button[disabled]{opacity:.6;cursor:not-allowed}
input{
  width:100%;padding:14px;border-radius:12px;border:none;
  margin-bottom:12px;font-size:15px
}
.timer{display:flex;justify-content:space-between;margin-top:10px}
.timer div{
  width:22%;background:#020617;padding:10px;border-radius:10px;text-align:center
}
.timer span{font-size:20px;font-weight:700}
.timer small{display:block;font-size:11px;opacity:.75}
.status{margin-top:10px;text-align:center;font-weight:600}
.section-title{font-weight:700;margin-bottom:6px}
.info{font-size:13px;opacity:.9;line-height:1.6}
footer{text-align:center;font-size:12px;opacity:.75;margin:12px 0}
</style>
</head>

<body>
<div class="container">

  <!-- LOGO -->
  <div class="logo">
    <!-- logo.png same folder (repo root) me hona chahiye -->
    <img src="logo.png" alt="GARV Logo">
  </div>

  <h1>GARV Token ‚Äì Stake Now</h1>

  <!-- CONNECT -->
  <div class="card">
    <button onclick="connectWallet()">üîó Connect Wallet</button>
    <div id="walletAddr" class="info"></div>
  </div>

  <!-- STAKE -->
  <div class="card">
    <input id="amount" type="number" placeholder="Enter GARV Amount">
    <button onclick="stake()">üîí Stake GARV</button>
  </div>

  <!-- COUNTDOWN -->
  <div class="card">
    <div class="section-title">‚è≥ Stake Lock Countdown</div>
    <div class="timer">
      <div><span id="days">00</span><small>Days</small></div>
      <div><span id="hours">00</span><small>Hours</small></div>
      <div><span id="minutes">00</span><small>Minutes</small></div>
      <div><span id="seconds">00</span><small>Seconds</small></div>
    </div>
    <div id="countdownStatus" class="status">Stake not started</div>
  </div>

  <!-- SUMMARY + WITHDRAW -->
  <div class="card">
    <div class="section-title">üìä Stake Summary</div>
    <p><b>Staked Amount:</b> <span id="summaryAmount">--</span></p>
    <p><b>Start Time:</b> <span id="summaryStart">--</span></p>
    <p><b>Unlock Time:</b> <span id="summaryUnlock">--</span></p>
    <p><b>Status:</b> <span id="summaryStatus">--</span></p>
    <button id="withdrawBtn" onclick="withdraw()" disabled>Withdraw GARV</button>
  </div>

  <!-- INFO SECTIONS -->
  <div class="card">
    <div class="section-title">üìò GARV Token Details</div>
    <div class="info">
      GARV is a BEP-20 utility token on Binance Smart Chain designed for transparency,
      long-term participation and non-custodial staking.
    </div>
  </div>

  <div class="card">
    <div class="section-title">üìä Stake Details</div>
    <div class="info">
      ‚Ä¢ Lock Period: 365 Days (Auto-Lock)<br>
      ‚Ä¢ One Active Stake per Wallet<br>
      ‚Ä¢ Fully On-Chain & Transparent
    </div>
  </div>

  <div class="card">
    <div class="section-title">‚öôÔ∏è Stake Process</div>
    <div class="info">
      Connect Wallet ‚Üí Enter Amount ‚Üí Confirm Stake ‚Üí Auto-Lock ‚Üí Withdraw after 365 days.
    </div>
  </div>

  <div class="card">
    <div class="section-title">üìú Terms & Conditions</div>
    <div class="info">
      Staked tokens remain locked for 365 days and cannot be withdrawn before maturity.
      This is a decentralized, non-custodial smart-contract based system.
    </div>
  </div>

  <footer>On-chain ‚Ä¢ Non-custodial ‚Ä¢ 365 Days Lock</footer>
</div>

<script>
/* ===== CONFIG ===== */
const STAKING_CONTRACT = "0xf5be3BbA8FB7cd06380b8D902eA976F0fAc8387F";
const ABI = [
  "function autoStake(uint256 amount)",
  "function withdraw()",
  "function getStakeInfo(address user) view returns(uint256,uint256,uint256,bool)"
];

let provider, signer, staking, user;

/* ===== WALLET ===== */
async function connectWallet(){
  if(!window.ethereum) return alert("Wallet not detected");
  provider = new ethers.providers.Web3Provider(window.ethereum);
  await provider.send("eth_requestAccounts",[]);
  signer = provider.getSigner();
  user = await signer.getAddress();
  staking = new ethers.Contract(STAKING_CONTRACT, ABI, signer);
  walletAddr.innerText = "Connected: " + user;
  loadSummary();
}

/* ===== STAKE ===== */
async function stake(){
  const amt = amount.value;
  if(!amt || amt<=0) return alert("Enter valid amount");
  const tx = await staking.autoStake(ethers.utils.parseUnits(amt,18));
  await tx.wait();
  alert("Stake successful");
  loadSummary();
}

/* ===== SUMMARY ===== */
async function loadSummary(){
  const info = await staking.getStakeInfo(user);
  const staked = ethers.utils.formatUnits(info[0],18);
  const start = new Date(info[1]*1000);
  const unlock = new Date(info[2]*1000);
  const active = info[3];

  summaryAmount.innerText = staked + " GARV";
  summaryStart.innerText = info[1]==0 ? "--" : start.toLocaleString();
  summaryUnlock.innerText = info[2]==0 ? "--" : unlock.toLocaleString();

  const now = Math.floor(Date.now()/1000);
  if(active && now < info[2]){
    summaryStatus.innerText = "üîí Locked";
    withdrawBtn.disabled = true;
    startCountdown(info[2]);
  } else if(active && now >= info[2]){
    summaryStatus.innerText = "‚úÖ Unlocked";
    withdrawBtn.disabled = false;
    countdownStatus.innerText = "Stake unlocked ‚Äì you can withdraw now";
  } else {
    summaryStatus.innerText = "--";
  }
}

/* ===== WITHDRAW ===== */
async function withdraw(){
  const tx = await staking.withdraw();
  await tx.wait();
  alert("Withdraw successful");
  loadSummary();
}

/* ===== COUNTDOWN ===== */
let timer;
function startCountdown(unlockTs){
  clearInterval(timer);
  timer = setInterval(()=>{
    const now = Math.floor(Date.now()/1000);
    let d = unlockTs - now;
    if(d<=0){clearInterval(timer);return}
    const daysV = Math.floor(d/86400); d%=86400;
    const h = Math.floor(d/3600); d%=3600;
    const m = Math.floor(d/60); const s = d%60;
    days.innerText=String(daysV).padStart(2,"0");
    hours.innerText=String(h).padStart(2,"0");
    minutes.innerText=String(m).padStart(2,"0");
    seconds.innerText=String(s).padStart(2,"0");
    countdownStatus.innerText="üîí Stake Locked ‚Äì Countdown running";
  },1000);
}
</script>
</body>
</html>
